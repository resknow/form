document.addEventListener("DOMContentLoaded",function(){var e=function(e,r,t){for(var n=0;n<e.length;n++)r.call(t,n,e[n])};e(document.querySelectorAll("[data-form]"),function(e,r){r.setAttribute("novalidate",!0)});var r=document.querySelectorAll("[data-form]");for(frms=0;frms<r.length;frms++)r[frms].addEventListener("submit",function(r){r.preventDefault();var t,n,a,i;n=r.target,a=n.querySelector('[type="submit"]'),i=a.innerHTML,a.innerHTML="Sending...",a.setAttribute("disabled",!0),t=new FormData(n);var o=n.querySelectorAll("input, select, textarea");e(o,function(e,r){r.classList.remove("is-invalid")});var l=n.querySelectorAll(".form-error");e(l,function(e,r){r.parentNode.removeChild(r)});var s=n.querySelector(".form-alerts");null!==s&&(s.innerHTML=""),fetch("/validate/",{method:"POST",body:t,cache:"default"}).then(function(e){return e.json()}).then(function(e){if(200==e.code)n.submit();else if(a.innerHTML=i,a.removeAttribute("disabled"),e.hasOwnProperty("data"))for(field in e.data.errors){var r=n.querySelector('[name="'+field+'"]');if(null!==r){r.classList.add("is-invalid");var t=document.createElement("p");t.className="form-error",t.innerHTML=e.data.errors[field],r.parentNode.insertBefore(t,r.nextSibling)}}else{if(0==n.querySelector(".form-alerts").length){var o=document.createElement("div");o.className="form-alerts",n.insertBefore(o,n.firstChild)}var l=document.createElement("div");if(l.classList.add("form-alert","negative"),l.innerHTML="<strong>Error:</strong> "+e.message,"undefined"==typeof o)var o=n.querySelector(".form-alerts");var s=o.lastChild;o.insertBefore(l,s.nextSibling)}})})});
